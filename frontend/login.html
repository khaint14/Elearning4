<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <title>Đăng nhập</title>
    <link rel="stylesheet" href="login.css" />
  </head>
  <body>
    <div class="container">
      <div class="card">
        <h2>Đăng nhập</h2>
        <input id="username" placeholder="Tên tài khoản" />
        <input id="password" type="password" placeholder="Mật khẩu" />

        <!-- Checkbox hiển thị mật khẩu -->
        <div class="checkbox-container">
          <input type="checkbox" id="showPw" onclick="togglePassword()" />
          <label for="showPw">Hiển thị mật khẩu</label>
        </div>

        <button onclick="login()">Đăng nhập</button>
        <p id="msg"></p>
      </div>
    </div>

    <script>
      // ✅ Hiện / ẩn mật khẩu
      function togglePassword() {
        const pw = document.getElementById("password");
        pw.type = pw.type === "password" ? "text" : "password";
      }

      // ✅ Xử lý đăng nhập
      async function login() {
        const username = document.getElementById("username").value.trim();
        const password = document.getElementById("password").value.trim();

        if (!username || !password) {
          document.getElementById("msg").innerText = "⚠️ Vui lòng nhập đầy đủ!";
          return;
        }

        const res = await fetch("/api/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, password }),
        });

        const data = await res.json();
        document.getElementById("msg").innerText = data.message;

        if (res.ok) {
          localStorage.setItem("user", JSON.stringify(data.user));
          window.location.href = "/index.html";
        }
      }
    </script>
  </body>
</html>
